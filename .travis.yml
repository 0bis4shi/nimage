sudo: required

services:
  - docker

install:
  - curl -sSf https://nim-lang.org/choosenim/init.sh | sh -s -- -y
  - export PATH=/home/moigagoo/.nimble/bin:$PATH

script:
  - nimble build

before_deploy:
  - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"

deploy:
  provider: script
  script: nimage publish $TRAVIS_TAG --bases=ubuntu,alpine --flavors=slim,regular,onbuild
  on:
    tags: true
